# 실무에서 발생할 수 있는 동시성 문제 예시

### 1. **Dirty Read (더티 리드)**

- **실무 상황**: A 트랜잭션이 고객 계좌에서 돈을 출금하는 작업을 수행 중입니다. 이 트랜잭션은 아직 커밋되지 않았는데, B 트랜잭션이 해당 계좌의 잔액을 조회합니다. B 트랜잭션이 커밋되지 않은 데이터를 기반으로 신용 점수를 계산하거나 다른 비즈니스 로직을 수행한다면, A 트랜잭션이 롤백되었을 때 B의 계산 결과가 잘못될 수 있습니다.
- **연관 문제**: 잘못된 데이터 기반으로 의사 결정을 내리게 되며, 이로 인해 금융 시스템의 데이터 무결성이 깨질 수 있습니다.

### 2. **Non-Repeatable Read (비반복 읽기)**

- **실무 상황**: 재고 관리 시스템에서 A 트랜잭션이 특정 상품의 재고 수량을 조회하고 있습니다. 이후 다른 트랜잭션 B가 그 상품의 재고를 변경합니다. A 트랜잭션이 다시 재고 수량을 조회할 때, 앞서 조회한 값과 다르게 나올 수 있습니다.
- **연관 문제**: 주문 처리 중 재고 수량이 변경되어 잘못된 주문 처리가 될 수 있습니다. 예를 들어, 상품이 재고에 있다고 확인하고 판매 처리했지만, 실제로는 재고가 부족할 수 있습니다.

### 3. **Phantom Read (팬텀 리드)**

- **실무 상황**: 인사 관리 시스템에서 부서 내 모든 직원의 평균 연봉을 계산하려는 트랜잭션 A가 있습니다. 이 트랜잭션 동안 다른 트랜잭션 B가 새로운 직원을 그 부서에 추가합니다. A 트랜잭션이 다시 평균 연봉을 계산하려고 할 때, 처음 조회했던 직원 수와 달라지며 결과가 변동됩니다.
- **연관 문제**: 보고서나 분석 결과가 일관성이 없게 되고, 잘못된 결론을 내릴 수 있습니다.

### 4. **Lost Update (갱신 손실)**

- **실무 상황**: 두 명의 고객이 동일한 항공편 예약 시스템에서 좌석을 선택하고 있습니다. A 고객은 좌석 10A를 선택하고 B 고객도 좌석 10A를 선택한 후 동시에 예약을 시도합니다. 한 명의 고객만이 예약을 완료하게 되고, 다른 고객의 선택은 무시될 수 있습니다.
- **연관 문제**: 사용자 경험이 저하되고, 고객 불만이 발생할 수 있습니다. 데이터베이스의 일관성이 깨질 위험도 있습니다.

### 5. **Deadlock (교착 상태)**

- **실무 상황**: ERP 시스템에서 A 트랜잭션이 자재 1을 요청하고, 자재 2에 대한 잠금을 시도하는 동시에, B 트랜잭션이 자재 2를 요청하고 자재 1에 대한 잠금을 시도합니다. 두 트랜잭션이 서로 상대방의 자원을 기다리면서 무한 대기에 빠집니다.
- **연관 문제**: 시스템 전체가 멈출 수 있으며, 비즈니스 프로세스가 중단되어 심각한 운영 문제가 발생할 수 있습니다.

### 6. **Serialization Anomaly (직렬화 이상)**

- **실무 상황**: 주식 거래 시스템에서 두 명의 사용자가 동일한 주식을 동시에 매수하려고 합니다. 시스템이 거래 순서를 잘못 처리하여, 실제로는 직렬화되어야 할 거래가 뒤섞이면서 예상과 다른 결과가 나타날 수 있습니다.
- **연관 문제**: 주식 가격이나 거래 처리에 오류가 발생하여, 거래 신뢰도가 떨어지고, 심각한 금전적 손실이 발생할 수 있습니다.

### 7. **Snapshot Isolation Violation (스냅샷 격리 위반)**

- **실무 상황**: 고객 관리 시스템에서 두 명의 상담원이 동일한 고객의 연락처 정보를 동시에 수정하고 있습니다. 각각의 트랜잭션은 독립적으로 수정된 정보를 기반으로 작업을 하지만, 마지막에 충돌이 발생할 수 있습니다.
- **연관 문제**: 데이터베이스의 일관성이 깨지고, 고객 정보가 잘못 저장될 수 있습니다. 이는 고객 서비스의 질을 저하시킬 수 있습니다.

### 8. **Double Spend (이중 지출)**

- **실무 상황**: 전자상거래 사이트에서 고객이 동일한 예산에서 두 개의 주문을 동시에 결제하려고 시도합니다. 동시성 문제로 인해 예산이 두 번 차감되거나, 두 개의 주문이 모두 유효하게 처리될 수 있습니다.
- **연관 문제**: 회사의 재무 데이터에 오류가 발생하며, 고객의 불만을 초래할 수 있습니다. 심각한 경우 법적 문제가 발생할 수도 있습니다.

### 9. **Lock Escalation (잠금 확장)**

- **실무 상황**: 은행 시스템에서 수많은 계좌에 대해 잠금을 설정하고 있습니다. 잠금의 범위가 행 수준에서 테이블 수준으로 확장되면서, 다른 트랜잭션이 해당 테이블에 접근하지 못하게 되어 시스템 전체가 느려집니다.
- **연관 문제**: 성능 저하와 병목 현상이 발생하여 시스템 가용성이 떨어지고, 사용자 경험이 저하될 수 있습니다.

### 10. **Atomicity Violation (원자성 위반)**

- **실무 상황**: 온라인 결제 시스템에서 트랜잭션이 여러 단계로 나뉘어 있습니다. 결제 중에 시스템 장애가 발생하여 일부 단계만 완료되고, 결제가 완료되지 않았음에도 재고는 감소한 상태로 남습니다.
- **연관 문제**: 재고 오류와 함께 고객 불만이 발생할 수 있으며, 재무 데이터의 일관성이 깨질 수 있습니다.

### 11. **Transaction Starvation (트랜잭션 기아)**

- **실무 상황**: 물류 관리 시스템에서 재고 확인 트랜잭션의 우선순위가 낮게 설정되어 있습니다. 다른 고우선순위 작업들이 계속 자원을 차지하면서, 재고 확인 작업이 오랫동안 대기하게 됩니다.
- **연관 문제**: 시스템 효율이 저하되고, 재고 확인 지연으로 인해 주문 처리에 차질이 발생할 수 있습니다.

### 12. **Lock Contention (잠금 경합)**

- **실무 상황**: 금융 시스템에서 여러 트랜잭션이 동시에 동일한 고객 계좌에 접근하여 입출금 작업을 수행하려고 합니다. 이로 인해 해당 계좌에 대한 잠금이 발생하고, 다른 트랜잭션들은 대기하게 됩니다.
- **연관 문제**: 시스템 성능이 저하되고, 사용자 대기 시간이 길어져 서비스 품질이 떨어질 수 있습니다.

### 13. **Inconsistent Read (일관성 없는 읽기)**

- **실무 상황**: 실시간 로그 분석 시스템에서 한 트랜잭션이 로그 데이터를 읽는 동안, 다른 트랜잭션이 그 데이터를 수정합니다. 처음 읽은 데이터와 이후 읽은 데이터가 일관성이 없는 상황이 발생할 수 있습니다.
- **연관 문제**: 분석 결과가 왜곡되어 잘못된 비즈니스 결정을 내릴 위험이 있습니다.

### 14. **Propagation Delay (전파 지연)**

- **실무 상황**: MySQL 복제 환경에서, 마스터 서버에서 데이터를 업데이트한 후, 슬레이브 서버로 데이터가 전파되기까지 지연이 발생합니다. 슬레이브 서버에서 데이터를 읽는 트랜잭션은 최신 상태가 아닌 데이터를 읽게 됩니다.
- **연관 문제**: 데이터 일관성이 깨지며, 특히 읽기 전용 노드를 사용하는 시스템에서 잘못된 데이터 제공이 발생할 수 있습니다.
